#!/bin/bash
# Exemplos prÃ¡ticos de uso da integraÃ§Ã£o AST

# Cores para output
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${BLUE}Exemplos de Uso: AST vs Original no directus_server.py${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""

# Exemplo 1: Processamento com AST (mÃ¡xima precisÃ£o)
echo -e "${GREEN}1. Processamento com AST (59.3% precisÃ£o)${NC}"
echo -e "${YELLOW}   Use quando: precisÃ£o Ã© crÃ­tica, documentos estruturados${NC}"
echo ""
echo "curl -X POST \"http://localhost:8001/api/process\" \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"versao_id\": \"322e56c0-4b38-4e62-b563-8f29a131889c\","
echo "    \"use_ast\": true"
echo "  }'"
echo ""
echo -e "${YELLOW}   Resultado esperado:${NC}"
echo "   - Total: 8 modificaÃ§Ãµes"
echo "   - 4 ALTERACAO, 2 REMOCAO, 2 INSERCAO"
echo "   - NÃºmeros de clÃ¡usulas auto-detectados"
echo "   - Estrutura do documento preservada"
echo ""

# Exemplo 2: Processamento tradicional (velocidade)
echo -e "${GREEN}2. Processamento Tradicional (51.9% precisÃ£o)${NC}"
echo -e "${YELLOW}   Use quando: velocidade Ã© prioridade, documentos simples${NC}"
echo ""
echo "curl -X POST \"http://localhost:8001/api/process\" \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"versao_id\": \"322e56c0-4b38-4e62-b563-8f29a131889c\","
echo "    \"use_ast\": false"
echo "  }'"
echo ""
echo -e "${YELLOW}   Resultado esperado:${NC}"
echo "   - Total: 6 modificaÃ§Ãµes"
echo "   - 6 ALTERACAO, 0 REMOCAO, 0 INSERCAO"
echo "   - Processamento mais rÃ¡pido"
echo ""

# Exemplo 3: Processamento padrÃ£o (sem especificar use_ast)
echo -e "${GREEN}3. Processamento PadrÃ£o (default: tradicional)${NC}"
echo -e "${YELLOW}   Backward compatible - cÃ³digo existente continua funcionando${NC}"
echo ""
echo "curl -X POST \"http://localhost:8001/api/process\" \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"versao_id\": \"322e56c0-4b38-4e62-b563-8f29a131889c\""
echo "  }'"
echo ""
echo -e "${YELLOW}   Nota: use_ast=false Ã© o padrÃ£o${NC}"
echo ""

# Exemplo 4: Uso em Python
echo -e "${GREEN}4. Uso via Python${NC}"
echo ""
echo "from directus_server import DirectusAPI"
echo ""
echo "api = DirectusAPI()"
echo ""
echo "# Com AST (recomendado)"
echo "resultado_ast = api.process_versao("
echo "    versao_id=\"322e56c0-4b38-4e62-b563-8f29a131889c\","
echo "    use_ast=True  # â† Ativa AST"
echo ")"
echo ""
echo "# Sem AST (tradicional)"
echo "resultado_original = api.process_versao("
echo "    versao_id=\"322e56c0-4b38-4e62-b563-8f29a131889c\","
echo "    use_ast=False  # â† PadrÃ£o"
echo ")"
echo ""
echo "# Comparar"
echo "print(f\"AST: {len(resultado_ast['modificacoes'])} modificaÃ§Ãµes\")"
echo "print(f\"Original: {len(resultado_original['modificacoes'])} modificaÃ§Ãµes\")"
echo ""

# Exemplo 5: Teste comparativo automatizado
echo -e "${GREEN}5. Teste Comparativo Automatizado${NC}"
echo -e "${YELLOW}   Compara ambas implementaÃ§Ãµes lado a lado${NC}"
echo ""
echo "# Terminal 1: Iniciar servidor"
echo "uv run python versiona-ai/directus_server.py"
echo ""
echo "# Terminal 2: Executar teste"
echo "uv run python versiona-ai/test_api_ast_vs_original.py"
echo ""
echo -e "${YELLOW}   SaÃ­da mostra:${NC}"
echo "   - ComparaÃ§Ã£o quantitativa (totais por tipo)"
echo "   - DiferenÃ§as entre implementaÃ§Ãµes"
echo "   - RecomendaÃ§Ã£o de qual usar"
echo ""

# Exemplo 6: Verificar disponibilidade AST
echo -e "${GREEN}6. Verificar Disponibilidade do AST${NC}"
echo ""
echo "# Ao iniciar servidor, verifica automaticamente:"
echo "uv run python versiona-ai/directus_server.py"
echo ""
echo -e "${YELLOW}   Output esperado:${NC}"
echo "   âœ… ImplementaÃ§Ã£o AST disponÃ­vel (59.3% precisÃ£o)"
echo ""
echo -e "${YELLOW}   Se Pandoc nÃ£o instalado:${NC}"
echo "   âš ï¸ ImplementaÃ§Ã£o AST nÃ£o disponÃ­vel - apenas modo texto (51.9% precisÃ£o)"
echo ""

# Exemplo 7: Modo mock com AST
echo -e "${GREEN}7. Modo Mock com AST (para testes)${NC}"
echo ""
echo "curl -X POST \"http://localhost:8001/api/process\" \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"versao_id\": \"mock_001\","
echo "    \"mock\": true,"
echo "    \"use_ast\": true"
echo "  }'"
echo ""
echo -e "${YELLOW}   Nota: mock=true desabilita AST (nÃ£o hÃ¡ arquivos DOCX mock)${NC}"
echo ""

# Exemplo 8: Processar modelo completo
echo -e "${GREEN}8. Processar Modelo Completo (todas versÃµes)${NC}"
echo ""
echo "curl -X POST \"http://localhost:8001/api/process-modelo\" \\"
echo "  -H \"Content-Type: application/json\" \\"
echo "  -d '{"
echo "    \"modelo_id\": \"d2699a57-b0ff-472b-a130-626f5fc2852b\","
echo "    \"use_ast\": true"
echo "  }'"
echo ""
echo -e "${YELLOW}   Processa todas versÃµes do modelo com AST${NC}"
echo ""

# Dicas de uso
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${BLUE}ğŸ’¡ DICAS DE USO${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo -e "${GREEN}Quando usar AST (use_ast=true):${NC}"
echo "  âœ… Documentos estruturados com clÃ¡usulas numeradas"
echo "  âœ… PrecisÃ£o Ã© crÃ­tica (contratos, documentos legais)"
echo "  âœ… Precisa detectar REMOCAO e INSERCAO separadamente"
echo "  âœ… FormataÃ§Ã£o inconsistente no documento"
echo ""
echo -e "${GREEN}Quando usar Original (use_ast=false):${NC}"
echo "  âœ… Velocidade Ã© prioridade"
echo "  âœ… Documentos simples sem estrutura clara"
echo "  âœ… Ambiente sem Pandoc instalado"
echo "  âœ… PrecisÃ£o de 51.9% Ã© suficiente"
echo ""
echo -e "${GREEN}Checklist antes de usar AST:${NC}"
echo "  â–¡ Pandoc instalado? (pandoc --version)"
echo "  â–¡ directus_server_ast.py existe?"
echo "  â–¡ Documentos sÃ£o DOCX vÃ¡lidos?"
echo "  â–¡ Servidor iniciou com \"âœ… ImplementaÃ§Ã£o AST disponÃ­vel\"?"
echo ""

# MÃ©tricas comparativas
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${BLUE}ğŸ“Š MÃ‰TRICAS COMPARATIVAS${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ MÃ©trica              â”‚   Original   â”‚     AST      â”‚   Melhoria  â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ PrecisÃ£o             â”‚    51.9%     â”‚    59.3%     â”‚    +7.4%    â”‚"
echo "â”‚ ALTERACAO detectadas â”‚      6       â”‚      4       â”‚ âœ… Correto   â”‚"
echo "â”‚ REMOCAO detectadas   â”‚      0       â”‚      2       â”‚ âœ… Detecta   â”‚"
echo "â”‚ INSERCAO detectadas  â”‚      0       â”‚      2       â”‚ âœ… Detecta   â”‚"
echo "â”‚ Estrutura preservada â”‚      âŒ       â”‚      âœ…       â”‚ âœ… BenefÃ­cio â”‚"
echo "â”‚ Tempo processamento  â”‚   ~1-2s      â”‚   ~3-5s      â”‚ âš ï¸ Mais lentoâ”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

# Links Ãºteis
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo -e "${BLUE}ğŸ“š DOCUMENTAÃ‡ÃƒO${NC}"
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
echo "  ğŸ“„ INTEGRACAO_AST_DIRECTUS.md - Guia completo de integraÃ§Ã£o"
echo "  ğŸ“„ RESUMO_INTEGRACAO_AST.md - Resumo das mudanÃ§as"
echo "  ğŸ“„ COMPARACAO_AST_VS_ORIGINAL.md - ComparaÃ§Ã£o detalhada"
echo "  ğŸ“„ API_DOCUMENTATION.md - DocumentaÃ§Ã£o da API"
echo ""
echo -e "${BLUE}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
